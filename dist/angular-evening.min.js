/*! angular-evening 09-09-2014 */
!function(){"use strict";angular.module("evening.evecollection",["thickm"]),angular.module("evening.evemodel",["thickm","evening.evecollection"]),angular.module("evening",["evening.evemodel","evening.evecollection"]),angular.module("evening.evecollection").factory("EveCollection",function(a,b){function c(){}a.extend(c),c._itemsField="_items",c._metaField="_meta";var d=function(a){a=a.split("?");var b=a.length>1?a[1].split("&"):a[0].split("&");if(""===b)return{};for(var c={},d=0;d<b.length;++d){var e=b[d].split("=");2===e.length&&(c[e[0]]=decodeURIComponent(e[1].replace(/\+/g," ")))}return c};return c.build=function(b,c){var d=a.build.call(this,b,c);return d._links=c.data._links,d},c.prototype.hasMore=function(){return angular.isDefined(this._links&&this._links.next)},c.prototype.loadMore=function(){var a=b.defer(),c=this;if(!this.hasMore())return a.reject(),a.promise;var e=d(this._links.next.href);return this._resourceClass.query(e).then(function(b){angular.forEach(b,function(a){c.push(a)}),c._links=b._links,c._meta.total=b._meta.total,c._meta.max_results+=b._meta.max_results,a.resolve(b)}),a.promise},c}),angular.module("evening.evemodel").factory("EveModel",function(a,b){function c(a){this._primaryField="_id",angular.extend(this,a),this._created="string"==typeof this._created?new Date(this._created):this._created,this._updated="string"==typeof this._updated?new Date(this._updated):this._updated}return b.extend(c),c._collectionClass=a,c.prototype.fieldsToApi=function(){var a={};return angular.forEach(this,function(b,c){("string"!=typeof c||"_"!==c.charAt(0))&&(a[c]=b)}),a},c.prototype.transformItemRequest=function(a){return this._etag&&(a["If-Match"]=this._etag),this.fieldsToApi()},c.search=function(a,b,c,d){return c=c||{$or:[]},b=b||{},a&&c.$or.push({$text:{$search:a,$language:d||"en"}}),0===c.$or.length&&(c={}),angular.extend(b,{where:c}),this.query(b)},c.query=function(a){for(var c in a)"object"==typeof a[c]&&(a[c]=JSON.stringify(a[c]));return b.query.call(this,a)},c.all=function(a){return a=a||{},angular.extend(a,{max_results:1e3}),this.query(a)},c})}(window,document);